pipeline {

	agent any
  
  stages {
   
    stage('Execute Jmeter') {

	    
	    steps {
              bat("dir")
              bat("jmeter -n -t sample.jmx -l Samplereport.jtl")
              step([$class: 'ArtifactArchiver', artifacts: '**/*.jtl'])
           
  
      	}
    }
  }
}

stage('Publish Performance Test Report') {
            steps {
                script {
                    // Specify the path to your JTL file(s)
                    def jtlFiles = 'Samplereport.jtl'

                    // Publish the performance report using the Jenkins Performance Plugin
                    perfReport percentiles: '0,50,90,95,99', errorFailedThreshold: 1, errorUnstableThreshold: 0,
                            relativeFailedThresholdPositive: 1, relativeFailedThresholdNegative: 1,
                            relativeUnstableThresholdPositive: 0, relativeUnstableThresholdNegative: 0,
                            sourceDataFiles: jtlFiles
                }
            }
        }
